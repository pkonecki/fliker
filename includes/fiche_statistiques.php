<?phpdefined('_VALID_INCLUDE') or die('Direct access not allowed.');$tot_asso=count(getAssociations($_SESSION['uid']));$tot_sec=count(getSections($_SESSION['uid']));$tot_act=count(getActivites($_SESSION['uid']));$tot_cre=count(getCreneaux($_SESSION['uid']));$tot = $tot_asso + $tot_sec + $tot_act + $tot_cre;if((strcmp($_SESSION['user'],"") == 0)){	print "<p>Vous n'êtes pas connecté</p>";	die();}if ($_SESSION['privilege'] == 1)	$tab_asso = getAssociations($_SESSION['uid']);else if (isset($tot_asso) && $tot_asso > 0)	$tab_asso = getAssociations($_SESSION['uid']);else if (isset($tot_sec) && $tot_sec > 0){	$tab_section = getSections($_SESSION['uid']);	$string_id_sec = "";	foreach ($tab_section as $tmp_array)		$string_id_sec .= ", ". $tmp_array['id'];	$string_id_sec[0] = ' ';	$res = doQuery("SELECT * FROM {$GLOBALS['prefix_db']}asso_section WHERE id_sec IN (".$string_id_sec.")");	$string_id_asso = "";	while ($tmp_array = mysql_fetch_array($res))		$string_id_asso .= ", ".$tmp_array['id_asso'];	$string_id_asso[0] = ' ';	$res = doQuery("SELECT * FROM {$GLOBALS['prefix_db']}association WHERE id IN (".$string_id_asso.")");	while ($tmp_array = mysql_fetch_array($res))		$tab_asso[$tmp_array['id']] = $tmp_array;}else{	print "<p>Vous n'avez pas accès à cette page!</p>";	die();}print '<ul id="submenu">';if(isset($tot_asso) && $tot_asso > 0)	print '<li><a class="'.(($_GET['page']==3) ? 'selected' : '').'" href="index.php?page=3">Associations</a></li>';if(isset($tot_sec) && $tot_sec > 0)	print '<li><a class="'.(($_GET['page']==4) ? 'selected' : '').'" href="index.php?page=4">Sections</a></li>';if(isset($tot_act) && $tot_act > 0)	print '<li><a class="'.(($_GET['page']==5) ? 'selected' : '').'" href="index.php?page=5">Activités</a></li>';if(isset($tot_cre) && $tot_cre > 0)	print '<li><a class="'.(($_GET['page']==6) ? 'selected' : '').'" href="index.php?page=6">Créneaux</a></li>';if(isset($tot_asso) && $tot_asso > 0)	print '<li><a class="'.(($_GET['page']==12) ? 'selected' : '').'" href="index.php?page=12">Utilisateurs</a></li>';if(isset($tot_cre) && $tot_cre > 0)	print '<li><a class="'.(($_GET['page']==20) ? 'selected' : '').'" href="index.php?page=20">Statistiques</a></li>';print '</ul>';if(isset($_GET['promo']))	$promo=$_GET['promo'];else	$promo=$current_promo;$currency = getParam('currency.conf');$tab_type = array("Nombre d'inscrits" => 0, "Homme/Femme" => 0, "Age" => 0, "Nombre d'inscrits à jour" => 0, "Statut" => 0);print "<table><tr align='center'><th></th>";	foreach ($tab_type as $key => $value)		print "<th>".$key."</th>";print "</tr>";foreach ($tab_asso as $asso){	print "<tr align='center'><td><b>".$asso['nom']."</b></td>";	// Initialisation des variables	$tab_stats = getStats($tab_type, $asso['id']);		foreach ($tab_stats as $key => $value)	{		print "<td>$value</td>";	}		// Récupération de la liste des sections	$sections = null;	if (isset($tot_asso) && $tot_asso > 0 || $_SESSION['privilege'] == 1)		$sections = getSectionsByAsso($asso['id']);	else	{		$res = doQuery("SELECT * FROM {$GLOBALS['prefix_db']}section WHERE id IN (SELECT id_sec FROM {$GLOBALS['prefix_db']}asso_section WHERE id_asso=".$asso['id']." AND id_sec IN (SELECT id_sec FROM {$GLOBALS['prefix_db']}resp_section WHERE id_adh=".$_SESSION['uid']."))");		while ($tmp_array_sec = mysql_fetch_array($res))			$sections[$tmp_array_sec['id']] = $tmp_array_sec;	}	$list_id_ent = array();	$list_id = array();	foreach ($sections as $key => $value)	{		$list_id[$key] = $key;		$list_id_ent[$key] = getActivitesBySection($key);		foreach ($list_id_ent[$key] as $key_act => $value_act)		{			$list_id_ent[$key][$key_act] = getCreneauxByActivite($key_act);			$list_id[$key] .= ', '.$key_act.'';			foreach ($list_id_ent[$key][$key_act] as $key_cre => $value_cre)				$list_id[$key] .= ', '.$key_cre.'';		}	}		// Affichage des données d'une section	foreach ($sections as $sec)	{		print "<tr align='center'>";		print "<td>".$sec['nom']."</td>";				// Initialisation des variables		$tab_stats = getStatsSec($tab_type, $asso['id'], $list_id[$sec['id']]);				foreach ($tab_stats as $key => $value)		{						print "<td>$value</td>";		}	}}?>